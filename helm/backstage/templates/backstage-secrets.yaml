{{- if index .Values "infra-services" "backstage_auth_secret" }}
apiVersion: v1
kind: Secret
metadata:
  name: backstage-secrets
  namespace: backstage
type: Opaque
stringData:
  # Backend auth secret
  AUTH_SECRET: {{ index .Values "infra-services" "backstage_auth_secret" | quote }}
  
  # Organization name
  ORGANIZATION_NAME: {{ index .Values "infra-services" "backstage_organization_name" | default "Backstage" | quote }}
  
  # GitLab integration
  {{- if index .Values "infra-services" "backstage_gitlab_token" }}
  GITLAB_TOKEN: {{ index .Values "infra-services" "backstage_gitlab_token" | quote }}
  {{- end }}
  {{- if index .Values "infra-services" "backstage_gitlab_host" }}
  GITLAB_HOST: {{ index .Values "infra-services" "backstage_gitlab_host" | quote }}
  {{- end }}
  {{- if index .Values "infra-services" "backstage_gitlab_api_base_url" }}
  GITLAB_API_BASE_URL: {{ index .Values "infra-services" "backstage_gitlab_api_base_url" | quote }}
  {{- end }}
  
  # GitHub integration
  {{- if index .Values "infra-services" "backstage_github_token" }}
  GITHUB_TOKEN: {{ index .Values "infra-services" "backstage_github_token" | quote }}
  {{- end }}
  
  # GitHub OAuth (auth provider) - note: uses AUTH_ prefix in app-config.production.yaml
  {{- if index .Values "infra-services" "backstage_github_client_id" }}
  AUTH_GITHUB_CLIENT_ID: {{ index .Values "infra-services" "backstage_github_client_id" | quote }}
  {{- end }}
  {{- if index .Values "infra-services" "backstage_github_client_secret" }}
  AUTH_GITHUB_CLIENT_SECRET: {{ index .Values "infra-services" "backstage_github_client_secret" | quote }}
  {{- end }}
  
  # Base URLs
  {{- if index .Values "infra-services" "backstage_base_url" }}
  APP_BASE_URL: {{ index .Values "infra-services" "backstage_base_url" | quote }}
  {{- end }}
  {{- if index .Values "infra-services" "backstage_backend_base_url" }}
  BACKEND_BASE_URL: {{ index .Values "infra-services" "backstage_backend_base_url" | quote }}
  {{- end }}
{{- end }}